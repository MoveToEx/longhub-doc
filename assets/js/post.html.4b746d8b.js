"use strict";(self.webpackChunklonghub_doc=self.webpackChunklonghub_doc||[]).push([[210],{293:(s,n,a)=>{a.r(n),a.d(n,{comp:()=>r,data:()=>u});var t=a(854);const e={class:"custom-container tip"},p=(0,t.Lk)("p",{class:"custom-container-title"},"TIP",-1),o=(0,t.Lk)("h1",{id:"endpoints",tabindex:"-1"},[(0,t.Lk)("a",{class:"header-anchor",href:"#endpoints"},[(0,t.Lk)("span",null,"Endpoints")])],-1),i={class:"table-of-contents"},l=(0,t.Fv)('<h2 id="crud" tabindex="-1"><a class="header-anchor" href="#crud"><span>CRUD</span></a></h2><h3 id="get-api-post" tabindex="-1"><a class="header-anchor" href="#get-api-post"><span>GET <code>/api/post/</code></span></a></h3><p>Query parameters:</p><table><thead><tr><th style="text-align:center;">Name</th><th style="text-align:center;">Description</th></tr></thead><tbody><tr><td style="text-align:center;"><code>offset</code></td><td style="text-align:center;">Skips first % results</td></tr><tr><td style="text-align:center;"><code>limit</code></td><td style="text-align:center;">Returns % results at most</td></tr></tbody></table><p>Response type:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">PostResponse</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    count<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>      <span class="token comment">// Total posts</span>\n    data<span class="token operator">:</span> Post<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>       <span class="token comment">// Requested data</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details class="custom-container details"><summary>Example</summary><p>Request:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code>GET https://longhub.top/api/post?limit=1&amp;offset=2\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Response:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span>\n<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>\n<span class="token application-json">\n<span class="token punctuation">{</span>\n  <span class="token string-property property">&quot;count&quot;</span><span class="token operator">:</span> <span class="token number">1987</span><span class="token punctuation">,</span>\n  <span class="token string-property property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n    <span class="token punctuation">{</span>\n        <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7b702e5e-a0c1-4e47-8375-5c0666db761b&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7b702e5e-a0c1-4e47-8375-5c0666db761b.jpg&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;imageURL&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://r2.longhub.top/posts/7b702e5e-a0c1-4e47-8375-5c0666db761b.jpg&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;imageHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1111111111011001111111111000011111111111000001101111111101111010&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-05-04T04:06:29.000Z&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-05-04T04:06:29.000Z&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;uploaderId&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;tags&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n            <span class="token punctuation">{</span>\n                <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n                <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;notext&quot;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n            <span class="token punctuation">{</span>\n                <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>\n                <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;monochrome&quot;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n            <span class="token punctuation">{</span>\n                <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>\n                <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;meaningless&quot;</span>\n            <span class="token punctuation">}</span><span class="token punctuation">,</span>\n            <span class="token punctuation">{</span>\n                <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">82</span><span class="token punctuation">,</span>\n                <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mirrored&quot;</span>\n            <span class="token punctuation">}</span>\n        <span class="token punctuation">]</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;uploader&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n            <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MoveToEx&quot;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">}</span>\n  <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="get-api-post-id" tabindex="-1"><a class="header-anchor" href="#get-api-post-id"><span>GET <code>/api/post/[id]</code></span></a></h3><p>Get a specific post.</p><p>Route parameters:</p><table><thead><tr><th style="text-align:center;">Name</th><th style="text-align:center;">Desc.</th></tr></thead><tbody><tr><td style="text-align:center;"><code>id</code></td><td style="text-align:center;">Post ID to query</td></tr></tbody></table><p>Response type: <code>Post</code></p><details class="custom-container details"><summary>Example</summary><p>Request:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code>GET https://longhub.top/api/post/7b702e5e-a0c1-4e47-8375-5c0666db761b\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Response:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span>\n<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>\n<span class="token application-json">\n<span class="token punctuation">{</span>\n    <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7b702e5e-a0c1-4e47-8375-5c0666db761b&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;7b702e5e-a0c1-4e47-8375-5c0666db761b.jpg&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;imageURL&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://r2.longhub.top/posts/7b702e5e-a0c1-4e47-8375-5c0666db761b.jpg&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;imageHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1111111111011001111111111000011111111111000001101111111101111010&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-05-04T04:06:29.000Z&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-05-04T04:06:29.000Z&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;uploaderId&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;tags&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span>\n            <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n            <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;notext&quot;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">{</span>\n            <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>\n            <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;monochrome&quot;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">{</span>\n            <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span>\n            <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;meaningless&quot;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">{</span>\n            <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">82</span><span class="token punctuation">,</span>\n            <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mirrored&quot;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;uploader&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MoveToEx&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="post-api-post" tabindex="-1"><a class="header-anchor" href="#post-api-post"><span>POST <code>/api/post/</code></span></a></h3><p>Creates a new post.</p><p>Requires create new post permission.</p><p>Accepts: <code>multipart/form-data</code></p><table><thead><tr><th style="text-align:center;">Form Field</th><th style="text-align:center;">Content Type</th><th style="text-align:center;">Description</th></tr></thead><tbody><tr><td style="text-align:center;"><code>image</code></td><td style="text-align:center;"><code>image/*</code></td><td style="text-align:center;">Image file. Must be less than 4 MiB.</td></tr><tr><td style="text-align:center;"><code>metadata</code></td><td style="text-align:center;"><code>application/json</code></td><td style="text-align:center;">Metadata of the new post. See below for details.</td></tr><tr><td style="text-align:center;"><code>force</code></td><td style="text-align:center;"><code>text/plain</code></td><td style="text-align:center;">Whether to ignore similar images. (0 for no, 1 for yes)</td></tr></tbody></table><p>The <code>image</code> file does not require a valid file name. Its file extension will be inferred from its <code>Content-Type</code> header.</p><p>Metadata schema:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Metadata</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    text<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n    tags<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    rating<span class="token operator">?</span><span class="token operator">:</span> Rating<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The following defaults will be used if a field is not present in the metadata:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> DefaultMetadata <span class="token operator">=</span> <span class="token punctuation">{</span>\n    text<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>\n    tags<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    rating<span class="token operator">:</span> <span class="token string">&#39;none&#39;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>New tags will be created if non-existing tag names are found.</p><p>Status codes:</p><ul><li><code>201 Created</code> if creation succeeds.</li><li><code>400 Bad Request</code> if request body does not correspond to schema.</li><li><code>409 Conflict</code> if similar images (hash difference less than 4 bits) are found.</li></ul><p>Response type:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">PostUploadResponse</span> <span class="token operator">=</span> Omit<span class="token operator">&lt;</span>Post<span class="token punctuation">,</span> <span class="token string">&#39;uploader&#39;</span><span class="token operator">&gt;</span> <span class="token operator">&amp;</span> <span class="token punctuation">{</span>\n    uploader<span class="token operator">:</span> Self\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">type</span> <span class="token class-name">PostConflictResponse</span> <span class="token operator">=</span> Pick<span class="token operator">&lt;</span>Post<span class="token punctuation">,</span> <span class="token string">&#39;image&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;imageURL&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;id&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;imageHash&#39;</span><span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details class="custom-container details"><summary>Example</summary><p>Request:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code>POST https://longhub.top/api/post\n<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">multipart/form-data; boundary=NMSL</span></span>\n<span class="token header"><span class="token header-name keyword">X-Access-Key</span><span class="token punctuation">:</span> <span class="token header-value">&lt;KEY&gt;</span></span>\n\n--NMSL\n<span class="token header"><span class="token header-name keyword">Content-Disposition</span><span class="token punctuation">:</span> <span class="token header-value">form-data; name=&quot;image&quot;; filename=&quot;image.jpg&quot;</span></span>\n<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">image/jpeg</span></span>\n\n&lt; ./image.jpg\n--NMSL\n<span class="token header"><span class="token header-name keyword">Content-Disposition</span><span class="token punctuation">:</span> <span class="token header-value">form-data; name=&quot;metadata&quot;</span></span>\n<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>\n<span class="token application-json">\n<span class="token punctuation">{</span>\n    <span class="token string-property property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nmsl&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;tags&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token string">&quot;monochrome&quot;</span>\n    <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n<span class="token operator">--</span><span class="token constant">NMSL</span>\nContent<span class="token operator">-</span>Disposition<span class="token operator">:</span> form<span class="token operator">-</span>data<span class="token punctuation">;</span> name<span class="token operator">=</span><span class="token string">&quot;force&quot;</span>\nContent<span class="token operator">-</span>Type<span class="token operator">:</span> text<span class="token operator">/</span>plain\n\n<span class="token number">0</span>\n<span class="token operator">--</span><span class="token constant">NMSL</span><span class="token operator">--</span>\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Response when succeeds:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span>\n<span class="token header"><span class="token header-name keyword">content-type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>\n<span class="token application-json">\n<span class="token punctuation">{</span>\n    <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;494784be-70a8-4236-8879-67c229644d98&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nmsl&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;494784be-70a8-4236-8879-67c229644d98.jpg&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;imageURL&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://r2.longhub.top/posts/494784be-70a8-4236-8879-67c229644d98.jpg&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;imageHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1100001111000010010010100000101001101101011010001011011100101001&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;aggr&quot;</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-02-09T01:07:23.642Z&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-02-09T01:07:23.642Z&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;uploaderId&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;tags&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span>\n            <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>\n            <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;monochrome&quot;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;uploader&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>\n        <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;email&quot;</span><span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;MoveToEx&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;permission&quot;</span><span class="token operator">:</span> <span class="token number">65310</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;accessKey&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;OMITTED&gt;&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;passwordHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;&lt;OMITTED&gt;&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-02-05T05:31:19.000Z&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">}</span>\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Response when conflicts:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">409</span> <span class="token reason-phrase string">Conflict</span></span>\n<span class="token header"><span class="token header-name keyword">content-type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>\n<span class="token application-json">\n<span class="token punctuation">[</span>\n    <span class="token punctuation">{</span>\n        <span class="token string-property property">&quot;imageURL&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://r2.longhub.top/posts/494784be-70a8-4236-8879-67c229644d98.jpg&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;494784be-70a8-4236-8879-67c229644d98&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;imageHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1100001111000010010010100000101001101101011010001011011100101001&quot;</span><span class="token punctuation">,</span>\n        <span class="token string-property property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;494784be-70a8-4236-8879-67c229644d98.jpg&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">]</span>\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="put-api-post-id" tabindex="-1"><a class="header-anchor" href="#put-api-post-id"><span>PUT <code>/api/post/[id]</code></span></a></h3><p>Modifies metadata of a post.<br> Requires edit post permission. Accepts: <code>application/json</code></p><p>Request body schema:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">UpdateSchema</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    text<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n    tags<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    rating<span class="token operator">?</span><span class="token operator">:</span> Rating<span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Fields not present in request body will remain unchanged.</p><p>Status codes:</p><ul><li><code>200 OK</code> if the post has been successfully modified.</li><li><code>400 Bad Request</code> if the given metadata is illegal.</li><li><code>404 Not Found</code> if the desinated post does not exist.</li></ul><p>Response type: <code>Post</code></p><details class="custom-container details"><summary>Example</summary><p>Modify post <code>bdf5394e-bbb9-4412-988c-3566ee14fbe2</code>, set text to <code>wcnm</code> and leave other fields unchanged:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code>PUT https://longhub.top/api/post/bdf5394e-bbb9-4412-988c-3566ee14fbe2\n<span class="token header"><span class="token header-name keyword">X-Access-Key</span><span class="token punctuation">:</span> <span class="token header-value">&lt;KEY&gt;</span></span>\n<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>\n<span class="token application-json">\n<span class="token punctuation">{</span>\n    <span class="token string-property property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wcnm&quot;</span>\n<span class="token punctuation">}</span>\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Response:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span>\n<span class="token header"><span class="token header-name keyword">content-type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>\n<span class="token application-json">\n<span class="token punctuation">{</span>\n    <span class="token string-property property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bdf5394e-bbb9-4412-988c-3566ee14fbe2&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;wcnm&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bdf5394e-bbb9-4412-988c-3566ee14fbe2.png&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;imageHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1000000000111001011011101011110010001100111101100110010111000101&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;imageURL&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://r2.longhub.top/posts/bdf5394e-bbb9-4412-988c-3566ee14fbe2.png&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-03-28T14:21:46.000Z&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-03-28T14:21:46.000Z&quot;</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;uploaderId&quot;</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>\n    <span class="token string-property property">&quot;tags&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="delete-api-post-id" tabindex="-1"><a class="header-anchor" href="#delete-api-post-id"><span>DELETE <code>/api/post/[id]</code></span></a></h3><p>Deletes a post.</p><p>Requires delete post permission.</p><p>Route parameters:</p><table><thead><tr><th style="text-align:center;">Name</th><th style="text-align:center;">Desc.</th></tr></thead><tbody><tr><td style="text-align:center;"><code>id</code></td><td style="text-align:center;">Post ID to delete</td></tr></tbody></table><p>Response: <code>204 No Content</code></p><details class="custom-container details"><summary>Example</summary><p>Request:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code>DELETE https://longhub.top/api/post/7b702e5e-a0c1-4e47-8375-5c0666db761b\n<span class="token header"><span class="token header-name keyword">X-Access-Key</span><span class="token punctuation">:</span> <span class="token header-value">&lt;OMITTED&gt;</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>Response:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">204</span> <span class="token reason-phrase string">No Content</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></details><h2 id="search" tabindex="-1"><a class="header-anchor" href="#search"><span>Search</span></a></h2><h3 id="post-api-post-search" tabindex="-1"><a class="header-anchor" href="#post-api-post-search"><span>POST <code>/api/post/search</code></span></a></h3><p>Accepts: <code>application/json</code></p><p>Query parameters:</p><table><thead><tr><th style="text-align:center;">Name</th><th style="text-align:center;">Description</th></tr></thead><tbody><tr><td style="text-align:center;"><code>offset</code></td><td style="text-align:center;">Skips first % results</td></tr><tr><td style="text-align:center;"><code>limit</code></td><td style="text-align:center;">Returns % results at most</td></tr></tbody></table><p>Request body schema:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Selector</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    type<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>                   <span class="token comment">// Selector type. See below for details</span>\n    op<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>        <span class="token comment">// Operation applied to the selector</span>\n    value<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>     <span class="token comment">// Right operand of the expression</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">type</span> <span class="token class-name">Order</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    key<span class="token operator">:</span> <span class="token string">&#39;createdAt&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;uploaderId&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span>\n    direction<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&#39;asc&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;desc&#39;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n<span class="token keyword">type</span> <span class="token class-name">SearchRequest</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    filter<span class="token operator">?</span><span class="token operator">:</span> Selector<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n    order<span class="token operator">?</span><span class="token operator">:</span> Order<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Response type:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">SearchReseponse</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    count<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>\n    data<span class="token operator">:</span> Post<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="filtering" tabindex="-1"><a class="header-anchor" href="#filtering"><span>Filtering</span></a></h4><p>The <code>filter</code> field specifies the condition applied on the posts. An empty <code>filter</code> array will cause a schema validation error.<br> Each item of <code>filter</code> must be of the following type:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Selector</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    type<span class="token operator">:</span> <span class="token string">&#39;text&#39;</span><span class="token punctuation">;</span>\n    op<span class="token operator">:</span> <span class="token string">&#39;contains&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;not_contains&#39;</span><span class="token punctuation">;</span>\n    value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token punctuation">{</span>\n    type<span class="token operator">:</span> <span class="token string">&#39;id&#39;</span><span class="token punctuation">;</span>\n    op<span class="token operator">:</span> <span class="token string">&#39;contains&#39;</span><span class="token punctuation">;</span>\n    value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token punctuation">{</span>\n    type<span class="token operator">:</span> <span class="token string">&#39;tag&#39;</span><span class="token punctuation">;</span>\n    op<span class="token operator">:</span> <span class="token string">&#39;include&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;exclude&#39;</span><span class="token punctuation">;</span>\n    value<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token punctuation">{</span>\n    type<span class="token operator">:</span> <span class="token string">&#39;rating&#39;</span><span class="token punctuation">;</span>\n    value<span class="token operator">:</span> Rating<span class="token punctuation">;</span>\n<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token punctuation">{</span>\n    type<span class="token operator">:</span> <span class="token string">&#39;createdAt&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;updatedAt&#39;</span><span class="token punctuation">;</span>\n    op<span class="token operator">:</span> <span class="token string">&#39;gt&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;gte&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;ge&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;lt&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;lte&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;le&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;eq&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;ne&#39;</span><span class="token punctuation">;</span>\n    value<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token builtin">number</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token builtin">number</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token builtin">number</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>     <span class="token comment">// *1</span>\n<span class="token punctuation">}</span> <span class="token operator">|</span> <span class="token punctuation">{</span>\n    type<span class="token operator">:</span> <span class="token string">&#39;system&#39;</span><span class="token punctuation">;</span>\n    op<span class="token operator">:</span> <span class="token string">&#39;untagged&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;disowned&#39;</span><span class="token punctuation">;</span>                <span class="token comment">// *2</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Note:</p><ol><li>The <code>value</code> field of date selector must be either of form <code>YYYY-MM-DD</code> or of form <code>YYYY-MM-DDTHH:mm:SSZ</code>, and must be a valid date. Otherwise a validation error will be returned. <strong>Timezone offsets are not allowed (like <code>2020-01-01T00:00:00+02:00</code>)</strong></li><li><code>disowned</code> operator matches posts that do not have an owner. This type of posts do exist because in early stages of LONG Hub there was no users and uploading was done without authentication.</li></ol><h4 id="ordering" tabindex="-1"><a class="header-anchor" href="#ordering"><span>Ordering</span></a></h4><p>The <code>order</code> specifies the order of the response.</p><p>Each item of <code>order</code> must be of the following type:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">Order</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    key<span class="token operator">:</span> <span class="token string">&#39;createdAt&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;uploaderId&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span>\n    direction<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">&#39;asc&#39;</span> <span class="token operator">|</span> <span class="token string">&#39;desc&#39;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>direction</code> field of an item will default to <code>asc</code> if not specified. The <code>order</code> field will default to the following value if not specified:</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">[</span>\n    <span class="token punctuation">{</span>\n        <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span>\n        <span class="token property">&quot;direction&quot;</span><span class="token operator">:</span> <span class="token string">&quot;asc&quot;</span>\n    <span class="token punctuation">}</span>\n<span class="token punctuation">]</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details class="custom-container details"><summary>Example</summary><p>Search for posts that are tagged with <code>monochrome</code>, rated as moderate, limited to 1 result, and sort by creation date in ascending order:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code>POST https://longhub.top/api/post/search?limit=1\n<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>\n<span class="token application-json">\n<span class="token punctuation">{</span>\n    <span class="token property">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span>\n            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tag&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;op&quot;</span><span class="token operator">:</span> <span class="token string">&quot;include&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;monochrome&quot;</span>\n        <span class="token punctuation">}</span><span class="token punctuation">,</span>\n        <span class="token punctuation">{</span>\n            <span class="token property">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;rating&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;value&quot;</span><span class="token operator">:</span> <span class="token string">&quot;moderate&quot;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;order&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span>\n            <span class="token property">&quot;key&quot;</span><span class="token operator">:</span> <span class="token string">&quot;createdAt&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;direction&quot;</span><span class="token operator">:</span> <span class="token string">&quot;asc&quot;</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Response:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span>\n<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/json</span></span>\n<span class="token application-json">\n<span class="token punctuation">{</span>\n    <span class="token property">&quot;count&quot;</span><span class="token operator">:</span> <span class="token number">402</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;data&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span>\n            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;00059cd3-c340-40e8-927b-301ad116bf18&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mai&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;00059cd3-c340-40e8-927b-301ad116bf18.jpg&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;imageURL&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://r2.longhub.top/posts/00059cd3-c340-40e8-927b-301ad116bf18.jpg&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;imageHash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;0011111000010111001100001101101010010000111110000001011010100001&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;aggr&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;rating&quot;</span><span class="token operator">:</span> <span class="token string">&quot;moderate&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;createdAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2023-12-29T13:45:24.000Z&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;updatedAt&quot;</span><span class="token operator">:</span> <span class="token string">&quot;2024-02-05T05:22:49.000Z&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;uploaderId&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;tags&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n                <span class="token punctuation">{</span>\n                    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span>\n                    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;monochrome&quot;</span>\n                <span class="token punctuation">}</span><span class="token punctuation">,</span>\n                <span class="token punctuation">{</span>\n                    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>\n                    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;mug&quot;</span>\n                <span class="token punctuation">}</span><span class="token punctuation">,</span>\n                <span class="token punctuation">{</span>\n                    <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token number">8</span><span class="token punctuation">,</span>\n                    <span class="token property">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;maimai&quot;</span>\n                <span class="token punctuation">}</span>\n            <span class="token punctuation">]</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;uploader&quot;</span><span class="token operator">:</span> <span class="token null keyword">null</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details><h3 id="post-api-post-similar" tabindex="-1"><a class="header-anchor" href="#post-api-post-similar"><span>POST <code>/api/post/similar</code></span></a></h3><p>Search for similar images.</p><p>Accepts: <code>multipart/form-data</code></p><p>Request body:</p><table><thead><tr><th style="text-align:center;">Field</th><th style="text-align:center;">Desc.</th></tr></thead><tbody><tr><td style="text-align:center;"><code>image</code></td><td style="text-align:center;">Image file to search</td></tr></tbody></table><p>Response schema:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">type</span> <span class="token class-name">SimilarPost</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n    image<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n    imageURL<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>\n    diff<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>       <span class="token comment">// Number of bits that are different from the request image</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n\n<span class="token keyword">type</span> <span class="token class-name">ResponseSchema</span> <span class="token operator">=</span> <span class="token punctuation">{</span>\n    hash<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>   <span class="token comment">// The hash of the incoming image</span>\n    similar<span class="token operator">:</span> SimilarPost<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><details class="custom-container details"><summary>Example</summary><p>Request:</p><div class="language-http line-numbers-mode" data-ext="http" data-title="http"><pre class="language-http"><code>POST https://longhub.top/api/post/similar\n<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">multipart/form-data; boundary=NMSL</span></span>\n\n--NMSL\n<span class="token header"><span class="token header-name keyword">Content-Disposition</span><span class="token punctuation">:</span> <span class="token header-value">form-data; name=&quot;image&quot;; filename=&quot;image.png&quot;</span></span>\n<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">image/png</span></span>\n\n&lt; ./image.png\n--NMSL--\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Response:</p><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token punctuation">{</span>\n    <span class="token property">&quot;hash&quot;</span><span class="token operator">:</span> <span class="token string">&quot;1100001111000010010010100000101001101101011010001011011100101001&quot;</span><span class="token punctuation">,</span>\n    <span class="token property">&quot;similar&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>\n        <span class="token punctuation">{</span>\n            <span class="token property">&quot;id&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fb852b83-71c7-4fb0-ab50-7e5eef044965&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;image&quot;</span><span class="token operator">:</span> <span class="token string">&quot;fb852b83-71c7-4fb0-ab50-7e5eef044965.jpg&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;imageURL&quot;</span><span class="token operator">:</span> <span class="token string">&quot;https://r2.longhub.top/posts/fb852b83-71c7-4fb0-ab50-7e5eef044965.jpg&quot;</span><span class="token punctuation">,</span>\n            <span class="token property">&quot;diff&quot;</span><span class="token operator">:</span> <span class="token number">0</span>\n        <span class="token punctuation">}</span>\n    <span class="token punctuation">]</span>\n<span class="token punctuation">}</span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></details>',74),c={},r=(0,a(209).A)(c,[["render",function(s,n){const a=(0,t.g2)("RouteLink"),c=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("div",null,[(0,t.Lk)("div",e,[p,(0,t.Lk)("p",null,[(0,t.eW)("Read "),(0,t.bF)(a,{to:"/api/schema.html"},{default:(0,t.k6)((()=>[(0,t.eW)("Schema")])),_:1}),(0,t.eW)(" first if you haven't read it.")])]),o,(0,t.Lk)("nav",i,[(0,t.Lk)("ul",null,[(0,t.Lk)("li",null,[(0,t.bF)(c,{to:"#crud"},{default:(0,t.k6)((()=>[(0,t.eW)("CRUD")])),_:1}),(0,t.Lk)("ul",null,[(0,t.Lk)("li",null,[(0,t.bF)(c,{to:"#get-api-post"},{default:(0,t.k6)((()=>[(0,t.eW)("GET /api/post/")])),_:1})]),(0,t.Lk)("li",null,[(0,t.bF)(c,{to:"#get-api-post-id"},{default:(0,t.k6)((()=>[(0,t.eW)("GET /api/post/[id]")])),_:1})]),(0,t.Lk)("li",null,[(0,t.bF)(c,{to:"#post-api-post"},{default:(0,t.k6)((()=>[(0,t.eW)("POST /api/post/")])),_:1})]),(0,t.Lk)("li",null,[(0,t.bF)(c,{to:"#put-api-post-id"},{default:(0,t.k6)((()=>[(0,t.eW)("PUT /api/post/[id]")])),_:1})]),(0,t.Lk)("li",null,[(0,t.bF)(c,{to:"#delete-api-post-id"},{default:(0,t.k6)((()=>[(0,t.eW)("DELETE /api/post/[id]")])),_:1})])])]),(0,t.Lk)("li",null,[(0,t.bF)(c,{to:"#search"},{default:(0,t.k6)((()=>[(0,t.eW)("Search")])),_:1}),(0,t.Lk)("ul",null,[(0,t.Lk)("li",null,[(0,t.bF)(c,{to:"#post-api-post-search"},{default:(0,t.k6)((()=>[(0,t.eW)("POST /api/post/search")])),_:1})]),(0,t.Lk)("li",null,[(0,t.bF)(c,{to:"#post-api-post-similar"},{default:(0,t.k6)((()=>[(0,t.eW)("POST /api/post/similar")])),_:1})])])])])]),l])}]]),u=JSON.parse('{"path":"/api/post.html","title":"Post API","lang":"en-US","frontmatter":{"title":"Post API"},"headers":[{"level":2,"title":"CRUD","slug":"crud","link":"#crud","children":[{"level":3,"title":"GET /api/post/","slug":"get-api-post","link":"#get-api-post","children":[]},{"level":3,"title":"GET /api/post/[id]","slug":"get-api-post-id","link":"#get-api-post-id","children":[]},{"level":3,"title":"POST /api/post/","slug":"post-api-post","link":"#post-api-post","children":[]},{"level":3,"title":"PUT /api/post/[id]","slug":"put-api-post-id","link":"#put-api-post-id","children":[]},{"level":3,"title":"DELETE /api/post/[id]","slug":"delete-api-post-id","link":"#delete-api-post-id","children":[]}]},{"level":2,"title":"Search","slug":"search","link":"#search","children":[{"level":3,"title":"POST /api/post/search","slug":"post-api-post-search","link":"#post-api-post-search","children":[]},{"level":3,"title":"POST /api/post/similar","slug":"post-api-post-similar","link":"#post-api-post-similar","children":[]}]}],"git":{"updatedTime":1736901516000,"contributors":[{"name":"MoveToEx","email":"39954725+MoveToEx@users.noreply.github.com","commits":3}]},"filePathRelative":"api/post.md"}')}}]);